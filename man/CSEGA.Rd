% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CSEGA.R
\name{CSEGA}
\alias{CSEGA}
\title{CSEGA: Cell-type Specific Expression-Guided Analysis}
\usage{
CSEGA(
  seu,
  group_var,
  gene,
  threshold_method = "kmeans",
  learn_grid = seq(0.01, 0.99, by = 0.01),
  min_cells_per_type = 5,
  verbose = TRUE
)
}
\arguments{
\item{seu}{A Seurat object containing single-cell transcriptomic data.}

\item{group_var}{Metadata column indicating the grouping variable (e.g., "celltype").}

\item{gene}{Target gene symbol (e.g., "DDIT3").}

\item{threshold_method}{Thresholding method, one of:
- "median", "mean", "q0.xx" (quantile-based);
- "kmeans" (two-cluster k-means);
- "learn" (automatically learns the best cutoff from quantiles 0.01–0.99);
- or a numeric value.}
}
\value{
A list containing:
  \item{summary}{Data frame of proportions, fold changes, odds ratios, logistic β values, and adjusted p-values.}
  \item{heatmap}{A ComplexHeatmap object visualizing compositional differences.}
  \item{bubbleplot}{A ggplot2 bubble plot showing High/Low proportions and significance.}
  \item{adaptive_cutoff}{The learned or applied cutoff threshold.}
  \item{models}{List of per-celltype logistic regression model objects.}
}
\description{
This function analyzes how the expression of a given gene is associated with the composition of each cell type
in a single-cell dataset. It extends the conventional thresholding methods (mean, median, quantile) by
introducing two advanced modes:
(1) **k-means-based thresholding**, which automatically partitions expression values into two clusters (High/Low);
(2) **"learn" mode**, which searches across quantile thresholds (from 1% to 99%) to identify the optimal cutoff
that maximizes the cell-type compositional divergence.

For interpretability, the function further fits a logistic regression model for each cell type:
\deqn{I(celltype == c_t) ~ expression}
estimating the β coefficient and its statistical significance, thereby quantifying how strongly the gene’s
expression level predicts the probability of belonging to that specific cell type.
}
\details{
The "learn" mode iteratively evaluates candidate thresholds and selects the one that maximizes
the chi-square statistic between High/Low groups and cell-type composition, thus making the threshold
data-driven rather than fixed. Logistic regression enhances interpretability by providing
effect size (β) and significance for each cell type.
}
